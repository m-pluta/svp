CC = gcc
CFLAGS = -I. -Werror -Wpedantic -Wall -Wextra -lm -O3
DFLAGS = -pg -O0

# List of source files
SRCS = src/main.c src/vector.c src/vector2d.c src/gram_schmidt.c src/schorr_euchner.c src/bound.c src/lll.c

# List of header files
HDRS = src/vector.h src/vector2d.h src/gram_schmidt.h src/schorr_euchner.h src/bound.h src/lll.h

# List of object files
OBJS = $(SRCS:.c=.o)

TESTCASE = [386470420 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [4032191714 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2405931857 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [641938694 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [3036997325 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2921425894 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [1426970717 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [1821396343 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2639139898 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [3306495764 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2197887529 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2468180333 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [4047721317 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [3178420728 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2585403726 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [216792761 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [208030820 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [327959605 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [4007166191 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [181114970 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [121941255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2583999028 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [1353583128 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [3636372606 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2030169364 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0] [2070196475 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0] [147066163 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0] [3978124969 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0] [71036257 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0] [2885778253 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0] [2094809605 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0] [1302902409 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0] [3597400744 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0] [1919013943 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0] [107974157 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0] [1437215964 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0] [3463982619 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0] [3804983160 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0] [3437675484 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1] [2110176757 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
TESTCASE_HARD = [137 156 163 73 75 109 101 157 142 239 157 92 207 3 40 159 105 250 63 68 66 100 19 176 113 226 163 69 44 132 206 111 223 187 75 22 26 116 22 149 137 27 246 245 174 140 180 180 79 49] [209 125 184 86 243 45 96 85 104 195 248 252 208 225 70 128 235 230 226 118 185 161 186 195 220 130 190 179 232 92 235 117 225 223 53 15 22 153 212 145 131 160 223 13 17 27 135 208 211 167] [227 243 4 200 244 168 137 80 91 29 53 5 72 34 167 66 90 131 23 39 170 150 215 32 90 151 55 26 143 116 112 72 247 181 252 235 201 65 237 21 103 149 22 251 88 235 80 90 84 137] [72 143 117 255 65 118 103 135 201 214 134 24 86 17 244 126 253 164 112 92 131 24 106 169 80 203 103 162 231 5 137 110 119 117 54 196 84 193 133 46 104 227 26 241 108 56 213 245 70 243] [181 60 172 99 243 178 210 62 83 132 229 183 157 110 234 223 15 124 253 35 77 238 235 28 29 39 91 242 185 217 21 10 120 119 180 124 170 71 242 233 187 28 93 2 56 102 38 223 106 216] [179 16 86 56 201 119 117 33 13 212 214 93 185 137 115 144 74 194 43 103 15 213 182 3 190 167 242 249 54 41 191 83 15 130 148 171 48 53 192 177 224 164 137 82 212 252 158 73 44 33] [86 220 161 20 34 195 235 217 100 35 208 127 235 237 76 154 133 216 218 94 193 193 198 16 160 106 230 187 253 149 18 112 70 97 243 43 21 76 183 242 158 92 227 240 49 51 55 82 42 194] [176 10 114 110 14 87 178 34 57 159 45 156 139 231 157 217 163 191 199 196 10 43 14 59 250 126 182 8 107 85 191 49 160 118 121 74 1 175 59 215 33 243 72 239 58 29 179 41 208 238] [147 72 132 238 229 239 55 193 161 114 111 86 67 80 121 19 100 38 105 141 212 255 5 75 91 109 7 21 178 18 12 212 237 41 175 73 14 53 231 135 236 27 110 75 138 134 137 231 241 239] [97 210 110 41 173 199 182 126 245 112 137 207 21 130 48 196 221 76 2 31 137 241 107 116 216 147 219 33 2 128 155 162 243 141 159 235 82 229 56 7 91 128 222 149 21 211 178 8 137 131] [214 194 6 23 104 108 93 39 103 87 177 212 106 38 70 189 186 101 76 163 166 176 175 234 124 62 224 185 126 98 21 143 149 106 142 128 243 42 35 106 135 144 186 146 66 40 93 76 151 23] [208 233 197 194 200 8 239 156 179 218 73 144 24 113 101 244 198 121 97 6 185 214 61 66 210 19 93 108 5 46 237 67 192 112 148 68 110 113 84 146 95 119 238 80 31 133 26 255 120 249] [67 3 108 186 108 167 101 167 44 174 42 185 72 238 55 237 75 76 12 7 59 211 117 237 181 193 7 156 48 176 44 127 36 40 76 132 7 157 98 254 8 77 154 65 158 223 182 174 203 87] [233 231 83 97 90 194 15 221 144 244 207 67 94 213 253 203 39 131 143 125 168 160 15 66 15 153 11 189 241 67 186 223 4 242 226 223 186 183 226 186 20 37 146 140 34 61 120 152 181 194] [22 224 98 69 36 21 119 176 35 192 123 196 3 184 133 37 2 123 215 228 137 78 247 220 11 144 252 8 153 132 1 38 234 80 8 236 135 71 19 84 57 224 37 2 201 135 114 148 165 197] [169 75 48 20 47 38 79 213 162 218 214 124 126 22 172 157 15 214 61 167 19 38 244 81 117 192 21 1 150 164 150 61 101 11 20 74 166 34 159 48 178 243 201 142 221 123 87 220 62 92] [71 147 148 45 81 134 55 252 153 96 148 20 160 135 199 121 42 213 164 7 7 192 14 24 82 45 65 69 181 90 181 117 8 215 29 80 150 31 25 133 255 230 154 73 98 147 210 107 208 112] [139 10 214 155 151 4 64 53 77 139 152 158 153 10 96 71 148 240 36 158 22 46 111 67 240 138 211 102 88 226 203 88 74 19 31 192 207 78 164 87 191 97 80 246 33 167 222 160 66 17] [216 41 22 219 196 11 228 255 104 25 69 248 33 191 141 77 154 22 20 17 229 74 111 28 127 241 236 162 196 217 187 131 147 11 164 124 227 3 29 254 79 214 139 203 156 10 68 114 248 240] [222 2 24 126 53 153 65 169 213 144 198 238 9 89 93 136 216 70 16 4 80 87 43 200 62 174 184 149 74 224 195 98 35 193 218 125 149 148 60 232 227 151 210 87 123 192 111 50 85 157] [219 87 110 105 58 15 113 98 164 152 18 234 3 35 213 174 215 6 185 236 155 144 30 195 200 78 54 10 167 201 239 187 179 5 190 141 63 57 157 98 49 166 182 124 6 138 164 93 29 15] [112 149 188 235 237 176 75 202 88 139 46 142 166 144 12 239 102 238 146 29 5 73 217 69 169 184 6 105 235 167 122 207 58 118 187 140 70 133 209 44 20 56 117 90 82 21 129 60 226 24] [165 164 184 212 195 165 19 121 58 154 185 97 92 223 15 125 85 224 124 227 150 167 65 143 22 170 161 224 214 10 22 122 195 110 11 254 250 6 55 117 30 56 4 89 82 0 27 139 106 229] [150 191 147 176 149 70 117 207 221 199 104 134 9 190 245 17 213 182 12 101 80 173 181 182 138 134 72 145 200 192 2 75 37 44 126 54 47 86 107 176 113 219 246 156 94 77 45 133 113 250] [157 69 247 7 128 43 20 102 10 35 119 6 237 16 68 233 181 36 216 110 240 161 241 19 120 78 190 83 89 250 164 109 128 90 199 125 64 119 241 162 152 110 187 80 39 144 180 132 93 99] [131 15 115 30 17 128 90 85 11 149 80 57 73 162 203 34 251 39 188 203 226 52 216 72 49 12 226 195 53 213 31 198 31 108 166 185 32 237 105 98 93 242 12 101 183 6 236 252 16 90] [159 61 243 128 182 81 108 97 141 104 60 91 81 222 60 198 178 115 12 11 149 234 158 92 75 203 252 30 15 116 155 209 26 108 1 105 229 177 133 197 61 185 20 69 123 218 83 73 127 188] [103 242 181 150 117 121 77 255 194 75 84 83 237 73 91 82 4 188 190 123 128 225 10 219 253 196 152 204 195 175 132 248 40 63 159 23 153 15 248 82 28 241 112 170 16 68 249 75 146 196] [98 252 125 130 221 89 3 120 55 22 242 68 111 129 2 155 223 58 228 158 136 84 247 140 116 30 140 123 192 184 7 153 79 234 123 189 155 98 87 10 88 57 1 159 17 130 207 152 180 246] [102 203 124 239 137 4 184 40 53 14 48 160 106 52 34 126 22 4 73 69 31 19 182 245 136 183 187 98 109 246 239 178 202 24 191 8 51 212 121 219 151 52 189 197 131 225 192 128 172 237] [51 182 164 200 98 211 158 192 137 74 40 55 103 231 153 219 140 6 192 159 9 85 150 59 214 200 163 68 110 240 3 124 239 147 75 105 191 22 183 6 197 102 82 79 47 137 242 246 79 174] [170 212 195 67 9 154 108 246 71 229 32 98 160 183 227 161 214 45 131 241 86 70 110 21 100 153 63 1 206 212 198 150 175 255 27 38 169 42 184 79 21 37 170 113 66 69 223 155 248 132] [232 47 20 13 48 162 52 220 217 121 142 62 22 125 38 163 35 246 1 177 127 159 176 116 247 228 93 2 119 249 200 187 206 195 226 58 131 80 128 175 9 250 238 18 175 71 34 112 227 244] [79 35 224 3 218 7 4 149 181 31 34 182 153 36 77 116 8 156 66 159 36 209 174 33 242 62 249 195 170 225 180 24 198 252 245 6 59 91 226 86 208 254 86 142 23 179 207 229 97 237] [103 45 31 203 79 121 249 15 92 156 134 33 36 78 77 48 218 22 198 187 82 192 97 141 80 14 240 24 177 98 158 137 70 238 240 128 226 16 84 116 120 183 138 251 240 44 41 191 197 129] [220 48 181 136 215 12 214 206 69 240 221 147 42 245 140 126 133 222 132 66 29 19 220 17 25 229 80 160 116 255 232 21 157 197 239 71 94 62 192 118 54 9 127 17 113 185 147 175 80 136] [219 243 192 132 22 97 169 219 217 245 138 11 0 204 160 136 86 115 45 236 188 28 190 47 79 107 139 14 125 237 93 244 136 109 159 179 216 90 238 135 114 161 76 243 243 220 13 236 194 197] [118 145 206 201 54 60 130 176 241 119 215 221 236 198 235 63 17 171 174 13 152 225 6 218 104 31 151 149 191 251 253 4 17 227 21 175 5 115 129 127 12 8 61 109 244 45 219 123 127 233] [240 9 233 66 71 2 56 127 32 248 226 113 185 107 46 191 177 94 171 131 38 137 127 172 168 172 113 127 213 189 212 20 181 151 111 173 114 82 239 50 176 104 117 161 164 44 61 26 204 151] [129 199 42 97 240 246 192 84 243 172 2 28 3 48 244 29 158 232 139 124 115 119 71 15 144 112 232 83 91 122 163 26 56 242 122 164 30 169 28 108 92 151 18 225 157 131 142 111 187 46] [29 252 208 121 171 225 162 111 93 13 4 31 38 126 129 6 112 238 168 102 230 43 26 79 123 162 14 29 112 12 41 31 121 172 171 127 9 89 22 218 45 124 61 105 155 195 27 140 34 181] [100 1 24 232 127 89 210 5 82 43 121 242 53 158 139 120 123 88 27 104 101 70 42 235 57 107 206 227 106 75 65 250 183 165 238 233 89 115 68 160 232 124 47 229 88 130 66 85 171 59] [129 46 79 83 63 178 225 31 227 170 171 205 143 97 112 56 31 159 91 47 75 237 22 151 105 125 211 75 41 223 9 44 240 226 125 179 236 122 54 15 155 142 95 50 27 6 36 254 150 237] [209 24 112 77 241 215 118 16 67 192 152 192 121 26 229 76 82 106 122 88 250 37 242 114 178 23 22 155 160 165 102 253 100 209 173 62 63 198 0 224 184 195 234 117 71 68 198 140 51 9] [216 194 62 158 246 40 227 67 165 64 42 172 241 125 250 161 246 62 184 64 22 205 171 126 7 146 199 23 3 49 224 33 249 183 241 185 243 134 157 243 172 98 203 199 55 78 82 59 228 241] [201 93 224 248 64 71 207 24 131 128 220 42 175 50 40 30 173 104 36 62 64 172 107 28 61 67 190 22 50 231 124 187 37 173 182 164 246 77 12 29 129 28 38 213 93 78 196 253 79 175] [211 214 202 224 163 191 191 137 221 171 228 246 145 120 140 238 173 206 105 170 18 188 107 74 30 197 212 5 175 58 209 171 116 202 16 132 104 130 113 246 181 157 65 210 111 54 45 74 213 207] [103 5 63 93 222 153 10 192 243 250 189 195 219 242 215 208 206 37 194 137 220 238 222 7 13 76 186 117 36 198 142 68 189 155 160 254 27 29 143 57 20 31 209 72 159 215 83 28 253 33] [1 217 107 155 15 127 53 208 96 139 157 48 25 50 71 76 175 183 178 221 192 32 22 116 225 220 184 108 9 223 242 187 133 142 150 55 209 96 255 139 114 39 131 35 112 9 93 42 92 4] [122 7 147 220 116 151 219 25 80 151 180 245 52 86 189 80 31 234 166 217 245 77 10 247 172 197 96 199 204 145 15 181 183 137 210 73 20 19 240 208 20 114 95 118 190 84 114 135 174 138] 


# The main target
all: runme

# Target to build the executable
runme: $(OBJS)
	$(CC) -o $@ $^ $(CFLAGS)

callgrind: clean
	make clean
	$(CC) -o runme $(SRCS) $(CFLAGS) $(DFLAGS)
	valgrind --tool=callgrind ./runme $(TESTCASE)
	kcachegrind callgrind.out.*

hyperfine:
	make clean
	make runme
	hyperfine "./runme $(TESTCASE)" > hyperfine.txt
	
# Test Suite
test: main.o tests/test.c
	$(CC) -o test tests/test.c main.o $(CFLAGS)
	./test

# Rule to build object files from source files
%.o: %.c $(HDRS)
	$(CC) -c $< -o $@ $(CFLAGS)

# Clean rule to remove generated files
clean:
	rm -rf runme $(OBJS) result.txt gmon.out callgrind.out.*

run:
	make all
	./runme [3.0 2.0] [1.0 -1.0]
	./runme [3.0 -70.0 2.0] [1.0 0.0 -1.0] [0.0 -7.0 9.0]
	./runme [87, 247] [147, 122]
	./runme [3164876632.0 1.0 0.0 0.0] [2493630228.0 0.0 1.0 0.0] [1060187369.0 0.0 0.0 1.0] [2699093087.0 0.0 0.0 0.0]
	make clean

.PHONY: all test clean

# cpplint --filter=-legal,-build --recursive .